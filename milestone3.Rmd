---
title: "Group Project"
author: "T11_Wed_reprex"
output: flexdashboard::flex_dashboard
  #bookdown::html_document2: default
  #bookdown::pdf_document2: default
  #fig_caption: yes
  #toc: yes
keep_md: TRUE
---


# Data Description
The data we have chosen for this project is the Australian Road Deaths Database (ARDD) provided by the Australian Bureau of Infrastructure and Transport Research Economics (BITRE). The records are updated monthly from 1986 to 2021. Here is the link to the database : https://data.gov.au/dataset/ds-dga-5b530fb8-526e-4fbf-b0f6-aa24e84e4277/details. 

There are two data files. The fatality data contains the demographic and details of people who have died within 30 days of the traffic accident due to injuries caused by an Australia road crash. The fatal crashes data contains the records for the crash, including information like the road type, and speed limit. The two data files can be connected by the crash ID. See Appendix for more detailed descriptions of each variable. 


# Research Questions:
Q1: What demographic has a higher rate of traffic accidents?

Q2: Ranking of vehicle types by number of accidents

Q3: How does the car accident fatality link with the district and accident type? 

Q4: Is there any correlation between accidents and holiday? And why are some explanations for the relation(s) or lack thereof.

Q5 :Has accident rate decreased or increased within the past decade (2010- 2020)? 

Q6: Possible correlations between number of fatalities and speed limit zone 


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```


```{r libraries, echo=FALSE}
# Loading package tidyverse:
#install.packages("DT")
library(tidyverse)
library(naniar)
library(ggplot2)
library(kableExtra)
library(flexdashboard)
library(DT)
```


```{r}
# read tidy data
fatalcrashes <- read.csv(here::here("data/cleaned_fatalcrashes.csv"))
fatalities <- read.csv(here::here("data/cleaned_fatalities.csv"))
head(fatalcrashes)
head(fatalities)
```

# Data Analysis

##Q1:


##Q2:


##Q3:

Question 3
===================================== 
#How does the car accident fatality link with the district and accident type? 

Column {data-width=500}
-------------------------------------

First of all, we group the data by state and the type of car which have involved in the fatal accidents.
```{r, eval=TRUE, echo=FALSE}

#no. of fatal accidents with bus involved
bus_involved <- fatalcrashes %>%
  filter(Bus.Involvement == "Yes") %>%
  group_by(State)%>%
  count() %>%
  rename("Bus_Involved" = n) 

#no. of fatal accidents with heavy truck involved
heavytruck_involved <- fatalcrashes %>%
  filter(Heavy.Rigid.Truck.Involvement == "Yes") %>%
  group_by(State)%>%
  count()%>%
  rename("Heavytruck_Involved" = n)

#no. of fatal accidents with articulated truck involved
articulated_truck_involved <- fatalcrashes %>%
  filter(Articulated.Truck.Involvement == "Yes") %>%
  group_by(State)%>%
  count()%>%
  rename("Articulated_truck_Involved" = n)

head(bus_involved)
head(heavytruck_involved)
head(articulated_truck_involved)
```


```{r, eval=TRUE, echo=FALSE}
#join the above 3 tables and turns them to long format
accident_car_type_count <- bus_involved %>%
  full_join(heavytruck_involved) %>%
  full_join(articulated_truck_involved) %>%
  pivot_longer(cols = c("Bus_Involved", "Heavytruck_Involved", "Articulated_truck_Involved"),  
               names_to = "Type",             
               values_to = "Count")
head(accident_car_type_count)
```
In this table, we have got the count of different type of fatal accidents happened group by different states. This data is in long format which will be easier for us to plot the bar chart for better visualization. 


```{r, eval=TRUE, echo=FALSE}
#plot the bar chart for the statistic of accident car type in different states
ggplot(accident_car_type_count, 
       aes( x = State, y = Count, fill = Type)) + 
  geom_col(position = "dodge") + 
  ggtitle("Number of Fatal Accidents with \nDifferent Car Type in Different State")

```

From the graph above:
 -NSW is the state with highest number of fatal accidents
 -follow by Qld and Vic. 
 
In all the states:
 -more than half of the total fatal accidents with articulated truck involved. 
 -Accidents with Heavy Truck involved account for the second large portion of the total accidents
 -follow by bus involved accidents. 
 
Interpretation:
Articulated truck is the heaviest among these 3 type of cars. Heavier car impose a greater impact on any accident which cause a higher fatalities. 

Articulated truck is a vehicle which has a permanent or semi-permanent pivot joint in its construction. Only large vehicles need this structure which is easier for them to turn. But it also impose an additional risk for higher fatalities in an accident due to the complex mechanical structure.


Then, we group the data by states and the type of Road Users which have involved in the fatal accidents.


```{r, eval=TRUE, echo=FALSE}
#How does the car accident fatality link with the district and accident type? 
accident_road_user_count <- fatalities %>%
  group_by(State, Road.User) %>%
  count() %>%
  rename(Count = n)
head(accident_road_user_count)
```


```{r,eval=TRUE, echo=FALSE}
#plot the bar chart for the statistic of accident road user type in different states
ggplot(accident_road_user_count, 
       aes( x = State, y = Count, fill = Road.User)) + 
  geom_col(position = "dodge") +
  labs(title = "Number of Fatal Accidents \nwith Different Road User in Different State")
```

From the graph above:
 
In all the states:
 -more than half of the total fatal accidents with drivers involved. 
 -Accidents with Passenger involved account for the second large portion of the total accidents
 -follow by motorcycle rider and then pedestrian involved accidents. 
 
Interpretation:
Most fatal accidents with the drivers and passengers involved. relatively less pedestrian involved in fatal car accidents. We may interpret that most of the people drive in Australia, that is the reason more drivers and passenger involved in fatal car accidents. Another interpretation is most of the car accidents happened in highway or it is a crashed between cars or crashed between car and the road.

Then, we group the data by the crash type and count the number of it.

Column {data-width=500}
-------------------------------------
```{r, eval=TRUE, echo=FALSE}
crash_type <- fatalities %>%
  group_by(State, Crash.Type) %>%
  count() %>%
  rename(Count = n)
head(crash_type)
```

```{r, eval=TRUE, echo=FALSE}
#plot the bar chart for the statistic of accident road user type in different states
ggplot(crash_type, 
       aes( x = State, y = Count, fill = Crash.Type)) + 
  geom_col(position = "dodge") +
  labs(title = "Number of Fatal Accidents \nwith Different Crash Type in Different State")
```
From the graph above:
 
In all the states except ACT and Tas:
 -all of the states have more single car crash than multiple car crash in terms of fatal car crashes.
 
How does the car accident fatality link with the district?
```{r, eval=TRUE, echo=FALSE}
#no. of fatal accidents in different district **with** NA value and arrange in decending order
district_fatalities <- fatalities %>%
  group_by(State,National.LGA.Name.2017) %>%
  count()%>%
  arrange(desc(n))
head(district_fatalities)

#no. of fatal accidents in different district **without** NA value and arrange in decending order
district_fatalities_without_NA <- fatalities %>%
  group_by(State,National.LGA.Name.2017) %>%
  count()%>%
  filter(!is.na(National.LGA.Name.2017))%>%
  arrange(desc(n))
head(district_fatalities_without_NA)
```

From the table above:
-first table contain value with NA
  -in this table, we don't have detail district information for some cases.              -However, in general, we could see that QLD, NSW, and Vic, these 3 states are         top 3 in terms of number of fatal accidents. 
##-***Be aware, this count do not reflect the actual ranking for the number of accidents.

-second table contain value without NA
  -in this table, we can conclude:
  +Brisbane in Qld is the district which has the most fatal car accidents happened,     which has 87 cases within this 10 years.
  +Follow by Central Coast in NSW which is 82 fatal car accidents happened
  +The third one is Gold Coast which has 68 cases in this 10 years.

Interpretation:
QLD, NSW, and Vic are the states that contain top 3 largest amount of population. Therefore, there will be higher chance of having a car accidents. 
It is the same as the district. Brisbane, Central Coast and Gold Coast are the districts with higher population which may leads to higher chance of an accident happened.

##Q4:


##Q5:


##Q6:
