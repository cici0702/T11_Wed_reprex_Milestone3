---
title: "Group Project"
author: "T11_Wed_reprex"
output: 
  bookdown::html_document2: default
  bookdown::pdf_document2: default
  fig_caption: yes
  toc: yes
keep_md: TRUE
editor_options: 
  chunk_output_type: console
---


# Data Description
The data we have chosen for this project is the Australian Road Deaths Database (ARDD) provided by the Australian Bureau of Infrastructure and Transport Research Economics (BITRE). The records are updated monthly from 1986 to 2021. Here is the link to the database : https://data.gov.au/dataset/ds-dga-5b530fb8-526e-4fbf-b0f6-aa24e84e4277/details. 

There are two data files. The fatality data contains the demographic and details of people who have died within 30 days of the traffic accident due to injuries caused by an Australia road crash. The fatal crashes data contains the records for the crash, including information like the road type, and speed limit. The two data files can be connected by the crash ID. See Appendix for more detailed descriptions of each variable. 


# Research Questions:
Q1: What demographic has a higher rate of traffic accidents?

Q2: Ranking of vehicle types by number of accidents

Q3: How does the car accident fatality link with the district and accident type? 

Q4: Is there any correlation between accidents and holiday? And why are some explanations for the relation(s) or lack thereof.

Q5 :Has accident rate decreased or increased within the past decade (2010- 2020)? 

Q6: Possible correlations between number of fatalities and speed limit zone 


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```


```{r libraries, echo=FALSE}
# Loading package tidyverse:
library(tidyverse)
library(naniar)
library(ggplot2)
library(kableExtra)
```


```{r}
# read tidy data
fatalcrashes <- read.csv(here::here("data/cleaned_fatalcrashes.csv"))
fatalities <- read.csv(here::here("data/cleaned_fatalities.csv"))
```

# Data Analysis

##Q1:


##Q2:


##Q3:


##Q4:

```{r}
holidays <- fatalcrashes %>%
  select(State, Year, Month, Christmas.Period, Easter.Period, Time.of.day)
```

```{r}
# detect the Christmas and Easter period month first
holidays1 <- holidays %>%
  select(Month, Christmas.Period, Easter.Period) %>%
  filter(Christmas.Period == "Yes" | Easter.Period == "Yes")

unique(holidays1$Month)
```

+ The month shows that the Christmas period is in December and January. And the Easter period is in March and April.

```{r}
library(lubridate)
library(plotly)
# filter month and check the holidays
monthly <- holidays %>%
  group_by(Month, State)%>%
  summarise(n = sum(Month))%>%
  mutate(Month = as.factor(Month)) 
  


#draw line plot
p1 <- ggplot(monthly, aes(x = Month, 
                    y = n, 
                    group = State, 
                    color = State)) +
  geom_line()+
  theme_bw()

ggplotly(p1)
```

+ This graph illustrates the monthly increase of fatalcrashes in eight states. We can see the increasing by the slope. There is no obvious correlation between the crashes and month.  



```{r}
library(dplyr)
# count the increase rate
holidays_rate <- monthly %>%
  arrange(State) %>%
  group_by(State) %>%
  mutate(diff = n - lag(n),
         rate = diff / n) %>%
  select(Month, State, rate)
```


```{r}
# plot the increase rate
p2 <- ggplot(holidays_rate)+
  geom_col(aes(x = Month, y = rate, fill = State))+
  scale_fill_brewer(palette = "Dark2")+
  theme_gray()+
  facet_wrap(~State)

ggplotly(p2)
```

+ Only ACT, NT, TAS has dominate increase in Christmas period.
While all the states decrease in Easter period except NT.


```{r}
# check the correlation with night and day
night <- holidays %>%
  select(Year, Time.of.day) %>%
  mutate(Time.of.day = as.factor(Time.of.day)) %>%
  group_by(Year, Time.of.day) %>%
  count()

# plot the day and night by year
p3 <- ggplot(night, 
       aes(x = Year, y = n, fill = Time.of.day), color = "Dark2")+
  geom_bar(stat = "identity")

ggplotly(p3)
```

+ Obviously, there are more crashes happen on the day.

##Q5:


##Q6:
